# 需求分析 [XQFX]

## 用户调研摘要
- **用户痛点**
  - 在面对大量信息时，用户难以快速找到所需内容，导致信息查找效率低下。
  - 当页面中存在多个可展开的面板时，用户可能会因为误操作而同时展开多个面板，从而使得页面显得杂乱无章，影响用户体验。
  - 对于一些有特殊需求的用户，如希望在面板标题中添加图标等元素来增强视觉效果，现有的面板组件可能无法满足其个性化需求。
  - 当面板中的内容较多或者操作较为复杂时，用户可能会因为缺乏明确的操作反馈而感到困惑，不知道自己的操作是否已经生效，或者当前处于何种状态。
- **期望功能**
  - 用户希望能够通过折叠面板的方式，将信息进行分类收纳，从而实现信息的层次化展示，方便快速定位和查找所需内容。
  - 用户希望能够灵活地控制面板的展开和收起，既可以同时展开多个面板以对比信息，也可以通过手风琴模式在多个面板之间进行切换查看，以满足不同的使用场景和需求。
  - 用户希望能够对面板的标题进行自定义，包括添加图标、修改文字样式等，以更好地表达面板的内容和重要性，提升界面的美观性和易用性。
  - 用户希望能够获得清晰明确的操作反馈，无论是通过样式更新还是交互效果，都能让用户清楚地感知到自己的操作结果，同时页面能够实时反映当前状态，增强用户的操作信心和掌控感。
- **安全性需求**
  - 在用户操作面板展开或收起的过程中，需要确保数据的完整性和一致性，避免因操作失误导致数据丢失或错误。
  - 对于一些可能涉及敏感信息的面板内容，需要采取相应的安全措施，如加密存储、访问权限控制等，以防止信息泄露。

## 竞品对比报告
| 竞品名称 | 功能特点 | 优势 | 劣势 |
| --- | --- | --- | --- |
| Element-UI 折叠面板 | 支持手风琴模式、可自定义面板标题、可设置面板的初始展开状态等 | 提供了丰富的功能选项，能够满足多种使用场景下的需求；样式美观，与 Element-UI 的整体设计风格保持一致，易于与其他组件搭配使用 | 在一些特殊场景下，如需要对面板的展开动画进行自定义时，可能不够灵活 |
| Ant Design 折叠面板 | 支持手风琴模式、可自定义面板标题、可设置面板的禁用状态等 | 功能强大且稳定，经过了大量项目的验证；提供了详细的文档和丰富的示例代码，方便开发者快速上手和使用 | 对于一些小型项目来说，可能会因为其庞大的体积而带来一定的性能负担 |
| Eric-UI 折叠面板 | 支持手风琴模式、可自定义面板标题、可设置面板的禁用状态等 | 代码简洁易懂，便于开发者进行二次开发和定制；提供了基本的折叠面板功能，能够满足常见的使用需求 | 相比于 Element-UI 和 Ant Design 等成熟的组件库，其功能相对较少，生态不够完善 |

## 市场趋势分析
- 随着互联网应用的不断发展和用户需求的日益多样化，折叠面板组件作为一种常见的信息收纳和展示方式，其市场需求持续增长。
- 用户对于折叠面板组件的易用性、灵活性和可定制性要求越来越高，希望能够通过简单的配置和操作，实现个性化的面板展示效果。
- 在移动互联网和响应式设计的背景下，折叠面板组件需要具备良好的适配性和兼容性，能够在不同尺寸的屏幕上提供一致的用户体验。
- 未来，折叠面板组件可能会与其他交互元素（如拖拽、排序等）进行深度融合，以满足更加复杂的业务场景和用户需求。

---

# 功能点设计 [GNSJ]

## 功能描述
- **基础折叠功能**：提供多个可折叠的面板，用户可以通过点击面板标题来展开或收起面板内容，实现信息的收纳和展示。
- **手风琴模式**：通过设置 `accordion` 属性，可将折叠面板组件切换为手风琴模式，在该模式下，一次只能展开一个面板，其他面板会自动收起，方便用户在多个面板之间进行切换查看。
- **自定义面板标题**：支持通过具名 slot 的方式对面板标题进行自定义，用户可以在标题中添加图标、修改文字样式等，以满足个性化需求。
- **禁用状态**：通过设置 `disabled` 属性，可将某个面板设置为禁用状态，禁用状态下的面板无法被点击展开，从而避免用户误操作。
- **操作反馈**：在用户点击面板标题进行展开或收起操作时，提供清晰明确的操作反馈，如通过样式更新（改变标题颜色、添加动画效果等）和交互效果（如面板内容的渐显或渐隐）让用户清楚地感知到操作结果，同时页面能够实时反映当前状态。

## API 设计
### Collapse 组件
- **Props**
  - `v-model`：类型为 `CollapseItemName[]`，用于绑定当前展开项的 `name`，默认值为 `[]`。
  - `accordion`：类型为 `boolean`，用于设置是否开启手风琴模式，当设置为 `true` 时，组件会切换为手风琴模式，一次只能展开一个面板，其他面板会自动收起，其默认值为 `false`。
- **Events**
  - `change`：当切换面板时触发，返回值为当前展开项的 `name` 数组，类型为 `(name: CollapseItemName[]) => void`。
- **Slots**
  - `default`：默认插槽，用于放置 `CollapseItem` 组件。

### CollapseItem 组件
- **Props**
  - `name`：类型为 `CollapseItemName`（`string | number`），作为面板的唯一标识符，用于区分不同的面板。
  - `title`：类型为 `string`，表示面板标题，默认值为 `""`。
  - `disabled`：类型为 `boolean`，用于设置面板是否禁用，当设置为 `true` 时，面板无法被点击展开，其默认值为 `false`。
- **Slots**
  - `default`：默认插槽，用于放置面板的内容。
  - `title`：用于自定义面板标题的插槽。

## 交互关系
- 用户点击某个未被禁用的面板标题时，如果当前组件处于手风琴模式，则会先判断该面板是否已经展开，若未展开，则将其展开，并将其他已展开的面板收起；若已展开，则将其收起。同时，触发 `change` 事件，并更新 `v-model` 绑定的值为当前展开项的 `name` 数组。
- 如果当前组件不处于手风琴模式，用户点击某个未被禁用的面板标题时，若该面板未展开，则将其展开，并将该面板的 `name` 添加到 `v-model` 绑定的数组中；若该面板已展开，则将其收起，并从 `v-model` 绑定的数组中移除该面板的 `name`。同时，触发 `change` 事件。
- 当面板处于禁用状态时，用户点击面板标题不会有任何操作响应，面板保持当前的展开或收起状态。
- 在面板展开或收起的过程中，通过样式更新和交互效果为用户提供清晰明确的操作反馈，如面板内容的渐显或渐隐动画、标题颜色的变化等，让用户清楚地感知到操作结果，同时页面能够实时反映当前状态。

## 功能实现细节
- **基础折叠功能实现**：通过监听面板标题的点击事件，结合 `v-model` 绑定的值来控制面板内容的显示与隐藏。当点击某个面板标题时，根据其 `name` 是否存在于 `v-model` 绑定的数组中来判断该面板是否应该展开或收起，并相应地更新 `v-model` 的值。
- **手风琴模式实现**：在手风琴模式下，当点击某个面板标题时，先判断该面板是否已经展开，若未展开，则将其他所有面板收起，并将当前面板展开，同时更新 `v-model` 的值为当前面板的 `name`；若已展开，则将其收起，并将 `v-model` 的值设置为空数组。通过这种方式，确保在手风琴模式下一次只能展开一个面板。
- **自定义面板标题实现**：通过具名 slot 的方式，允许用户在 `CollapseItem` 组件中自定义面板标题的内容。用户可以在 `title` 插槽中添加任意的 HTML 元素，如图标、文字等，以实现个性化的标题效果。
- **禁用状态实现**：通过为 `CollapseItem` 组件添加 `disabled` 属性，当该属性值为 `true` 时，为面板标题添加相应的禁用样式（如降低透明度、添加禁止点击的图标等），并通过事件监听阻止用户对该面板标题的点击操作，从而实现面板的禁用状态。
- **操作反馈实现**：在面板展开或收起时，通过 CSS 动画（如 `transition`）实现面板内容的渐显或渐隐效果，同时在面板标题上添加一些动态的样式变化（如颜色变化、添加动画效果等），为用户提供清晰明确的操作反馈。此外，还可以通过触发 `change` 事件，将当前展开项的 `name` 数组传递给父组件，以便父组件能够根据需要进行相应的处理和反馈。

## 用户操作流程
1. 用户进入包含折叠面板组件的页面，看到多个折叠面板，每个面板都有一个标题。
2. 用户点击某个面板标题，如果该面板未被禁用，且当前组件不处于手风琴模式，若该面板未展开，则面板内容展开，同时该面板的 `name` 被添加到 `v-model` 绑定的数组中；若该面板已展开，则面板内容收起，同时该面板的 `name` 从 `v-model` 绑定的数组中移除。用户在面板展开或收起的过程中，可以看到面板内容的渐显或渐隐动画以及标题颜色的变化等操作反馈。
3. 如果当前组件处于手风琴模式，用户点击某个面板标题时，若该面板未展开，则其他已展开的面板会自动收起，当前面板展开，同时 `v-model` 的值更新为当前面板的 `name`；若该面板已展开，则将其收起，`v-model` 的值设置为空数组。用户同样可以感受到操作反馈。
4. 当用户遇到被禁用的面板时，点击面板标题不会有任何操作响应，面板保持当前状态，用户可以通过面板标题上的禁用样式（如降低透明度、禁止点击的图标等）了解到该面板处于禁用状态。
5. 用户可以根据自己的需求，通过自定义面板标题，在面板标题中添加图标、修改文字样式等，以更好地表达面板的内容和重要性，提升界面的美观性和易用性。

## 异常处理
- **数据绑定异常**：如果 `v-model` 绑定的值不符合要求（如不是 `CollapseItemName[]` 类型），组件应该能够进行合理的处理，如发出警告信息提示开发者，并尝试使用默认值或忽略错误数据，以保证组件的正常运行。
- **非法操作处理**：当用户尝试对禁用状态的面板进行点击操作时，组件应该能够识别并阻止该操作，同时不触发任何事件或更新状态，避免出现意外情况。
- **性能优化**：在面板展开或收起的过程中，可能会涉及到 DOM 的频繁操作，组件需要通过合理的优化措施（如减少不必要的 DOM 操作、使用虚拟 DOM 等）来提高性能，避免出现卡顿或延迟现象，确保用户能够获得流畅的操作体验。
- **兼容性处理**：组件需要在不同的浏览器和设备上进行充分的测试，确保在各种环境下都能正常工作，对于一些存在兼容性问题的浏览器或设备，需要通过相应的兼容性处理措施（如使用 CSS 前缀、polyfill 等）来保证组件的功能和样式不受影响。

